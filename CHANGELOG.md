## Ближайшие планы

- Повысить производительность приложения обойдя питоновский GIL
- Сделать переводы интерфейса на Английский, Французский, Немецкий, Итальянский и Испанский
- Отрефакторить весь код (в основном под модель MVC)
- Сделать релиз и написать подробную документацию
- Автоматическая ассоциация с файлами изображений через реестр Windows







### 1й этап (декабрь 2022 - апрель 2023)
- дефолтная превьюшка теперь может быть полностью прозрачной и это контролируется через соответствующую настройку
- теперь программа сворачивается в трей, когда окно закрывается. Сделано это для того, чтобы при каждом запуске не пришлось ожидать долгой загрузки папок сессии из библиотеки
- в меню трея программа выводит статистику сожранной памяти
- иконки у панели управления теперь расположены на затенённом фоне, что облегчит их нахождение, когда просматривается светлая картинка
- перерисованы кнопки увеличения и уменьшения масштаба на панели управления
- доработка lite mode:
    - теперь можно выйти в lite mode не только для папки, но и для текущей картинки и доступно через контекстное меню. При этом окно новой копии программы в lite mode открывается по возможности на другом мониторе
- в контесное меню превьюшек добавлена опция сканирования папки в глубину: при сканировании в глубину будут добавлены не только изображения в текущей папке, но и в её подпапках тоже. Опция сохраняется в файле сессии и даёт эффект при первоначальной загрузке и при принудительном обновлении папки
- приложение научилось определять когда оно запускается из Sublime Text
- добавлена история просмотра картинок
    - историю просмотра отображает второй ряд мелких превьшек, расположенный сверху
    - `Alt+стрелка` для возвращения к предыдущей показанной картинке
    - история может быть либо для одной папки, либо для всех сразу (глобальная история), есть соотвествующая настройка
    - при достижении краёв списка истории выдаётся сообщение
- выполнен рефакторинг отдельных частей программы
    - settings api
    - разнёс код из главного файла по другим новым файлам
    - отрисовка мелких превьюшек
    - код сокетов
    - QMovie переписан, чтобы анимированный контент отображался не через костыльный QLabel, а через отрисовку, как это сделано для статических изображений
- сделана затухающая подцветка центрального лейбла в стиле начала глав Half Life 2, чтобы можно было понять, обновляется ли сообщение или нет
- добавлена настройка для размера превьюшек во вьювере
- теперь изображения стремятся занять максимально возможное пространство экрана благодаря использованию функции `fit`
- нарисована иконка по подобию Chromium в Photoshop. Потом переделаю её в Blender
- для целей отладки в левом верхнем углу выводится инфа из стандартного выхода, это можно отключить в настройках
- теперь если клавиша перелистывания изображений зажата, то отменяется анимация, которая в таком случае замедляет перелистывание. Вдобавок вообще для любого значения пропускается интерполяция, если начальные и конечные значения совпадают, и в итоге опять же избавляемся от задержки листания при зажатой клавише
- нажатие на `Esc` сначала закрывает окно с настройками, если оно открыто, и только при повторном нажатии закрывается само приложение
- добавлена настройка для запуска в трей, при чём в таком случае окно не показывается сразу, а только после клика по иконке трея, и тогда показывается окно со стартовой заглушкой (стартовая страница), которая приглашает к выбору папки для просмотра.
- в настройках перереработан вид чекеров: теперь ясно видно, что отключено, а что включено
- повороты теперь реализованы за счёт поворота самой картинки в памяти, а не за счёт поворота холста
- переработана функция кадрирования, доступная через клавишу `R` или `Shift+R`. Под эту функцию в настройках добавлена строка для пути, по которому будут сохраняться кадрированные изображения. `Ctrl+R` даст сбросить текущий путь и задать новый
- прога теперь может показывать метадату во вьювере, если таковая имеется в файле изображения. Для этого в настройки добавлена соответствующая галочка
- появился скролл колесом на странице библиотеки для каждой колонки и отрисовка некликабельных скроллбаров
- кадрирование теперь может работать с кадрами из анимированных картинок
- теперь можно задавать прямоугольную область интереса на изображении и добавлять к ней комментарий
- доработан UX просмотра анимированного контента
    - при перелистывании на другую картинку программа запоминает стояла ли анимация на паузе или нет
    - более удобная покадровая прокрутка через зажатую левую кнопку мыши
- появилась возможность растягивания программы на два монитора на странице библиотеки, в итоге левый столбец расположится на первом мониторе, а правый столбец - на втором
- появилась возможность перемещать полноэкранное окно с монитора на монитор с помощью `Ctrl+стрелка`
- по просьбе добавлена визуальная фича для антуража, которая делит пространство на квадраты, прозрачность которых плавно и рандомно меняется как в загрузочной заставке Splinter Cell Black List. Любой такой квадрат будет возвращаться к полной прозрачности, если над ним находится курсор мыши
- теперь перед открытием вьювера для конкретной папки или для конкретного изображения программа покажет стартовый диалог, в котором можно будет выбрать вариант открыть приложение в лайтовом режиме или вариант открыть в обычном, когда перед непосредственным открытием окна в самом начале много времени уходит на сканирование папок сессии добавленных в библиотеку
- в лайтовом режиме теперь отключена отрисовка комментов


### 2й этап (май 2023 - 28 сентября 2023)
- Стартовый диалог теперь имеет третью опцию — «Закрыть». Она позволяет вообще не запускать программу. Клик по крестику в углу делает то же самое
- Теперь svg-файлы (расширения `.svg`, `.svgz`) растеризуются в приемлемом разрешении, которое можно изменять через пункт контестного меню «Изменить разрешение растеризации SVG-файла»
- Добавлена настройка «Запускать лайтовый режим сразу и без диалога»
    - это позволяет пропускать диалог выбора режима упрощённый или обычный (библиотечный)
    - перезапуститься из лайтового в обычный режим можно через команду контекстного меню
- В контестное меню добавлена команда «Перезапуск» для сброса лишней памяти
    - если была открыта библиотека, то при перезапуске тоже будет открыта библиотека
- В файл `history.log` в папке программы теперь прописывается все запросы к приложению с датой и путём до запрашиваемых картинки или папки
- UX: теперь активация `Scroll Lock` через одноимённую клавишу переносит функционал клавиш `WASD` на клавиши со стрелками
- В контекстном меню появилась команда **Свернуть** для сворачивания окна, собственно
- !!!! ***обнаружен баг: после предварительного сворачивания через сочетание Win+Key Down при разворачивании кликом мышки по панели задач адекватно не появляется рамка у окна. Решения пока найти не удалось. Попытки решить прописаны в методе changeEvent. Код в changeEvent на данный момент вызывает бесконечный цикл и внезапно баги даже в окнах других приложений***
- Исправлен баг с залипанием нажатой левой клавиши при переходе окна в режим "с рамкой"
- Исправлен баг, когда при отсутствии повёрнутого изображения сообщение о отсутствии изображения показывалось с тем же поворотом, какое было у самого изображения
- Добавлена возможность менять местами порядок миниатюрок в той части ряда панели управления, что видна на мониторе. Работает через зажатие левой кнопки мыши.
- Добавлена система тегов:
    - при наведении мышки к левому краю во вьювере появится панель, на которой будут отображены все теги для данного изображения
    - через клавишу `T` доступна форма задания тегов и создания новых, прятается она через клавишу `Esc`. Щелкнув правой кнопкой мыши по лейблу тега отмеченные им изображения можно посмотреть в сгенерированной html-странице
    - для каждого тега система хранит два файла в папке tagging: первый содержит имя тега и его описание, второй содежит список файлов
- Из-за того, что клавиша `T` теперь используется в системе тегов, включить и выключить трети отныне можно с помощью клавиши `D`
- Теперь при перелистывании есть возможность видеть файлы любого типа, если в настройках деактивирована галочка **Показывать только изображения**. Фича нужна для того, чтобы иметь возможность замечать в папках с изображениями лишние файлы. Уже сейчас содержимое текстовых файлов (`.log`, `.txt`, `.url`, `.ini`) отображается в плашке об ошибке, которая выводится заместо картинки.
- Пофиксил баги для фичи перемещения миниатюрок
- Пофиксил баг с unicode
- !!!! ***Заметил кое-что важное: разрабатывая программу лишь несколько дней в месяц я стал забывать что и когда сделано, и недавно сделал фигню, например, не сделал модальными всплывающие окна настроек, комментария и тегов. Когда сделал, это решило кучи проблем с UX***
- Все формы (форма настроек, форма тегов, форма комментария) теперь модальные. Клавишей `Esc` каждую из них можно закрыть
- В форме тегов при клике по лейблам тегов теперь не возбуждается (не показывается назойливо) Completer в текством поле
- Кнопки поворота картинки поменяны местами на панели управления
- Отражать картинку во вьювере теперь можно и по вертикали, для этого нужно лишь зажать `Ctrl` перед нажанием клавиши `M`
- Создавая фичу, благодаря которой можно увидеть в списке не только картинки в папке, но и другие файлы, я забыл выключить для этих НЕкартинок вычисление md5-хэша. Из-за этого например, при попытке открыть картинку в папке, в которой лежало ещё и видео размером 500 МБ, время загрузки увеличилось почти на 3 секунды. Это нужно было исправлять, и сейчас это всё исправлено. Файлы, у которых md5-хэш не вычисляется, по сути не считаются картинками, и из-за этого теперь их нельзя добавлять даже в избранное.
- Теперь программа может читать AVIF, HEIF и HEIC-файлы
- Теперь при увеличении с 1% в большую сторону картинка некоторое время будет центироваться на позиции курсора. Это сделано для того, чтобы она резко не вылетела за края окна (из области видимости)
- Надпись стартовой страницы больше не мелькает на доли секунды при открытии изображения из проводника. Надпись "Загрузка" теперь выдаётся сразу на нескольких языках, а не на рандомном одном
- Теперь миниатюрки создаются по очереди в обе стороны от текущей миниатюрки, что в результате даёт приятный анимационный эффект, который в Picasa Photo Viewer ещё украшен постепенным масштабированием каждой миниатюрки по диагонали. Здесь от лишних анимационных украшений пришлось отказаться, потому что на Python летать (работать без фризов) это не будет, поэтому вышло скромней. Но всё равно ещё одна частичка Picasa Photo Viewer передана. Раньше превьюшки создавались в порядке следования - строго от первой до последней, не учитывая положение текущей превьюшки.
- Миниатюры в нижней части вьювера теперь проскальзывают при листании изображений как в Picasa Photo Viewer. Однако из-за долгой прогрузки самих картинок для подготовки к показу в главном потоке приложения, анимация иногда задерживается. Эта анимация вырубается через общую настройку для всех анимаций. Во время этой таски пришлось рефакторить систему анимации.
- Теперь при масштабировании изображения исключены резкие скачки. Для желающих вернуться к прежнему методу масштабирования в настройках появился соответствующий пункт. (и 5 ноября он уже удалён)
    Новый метод работает за счёт добавления к исходной ширине или вычитания из исходной ширины картинки дробной величины от всё той же исходной ширины, а затем по исходной ширине и новой ширине вычисляется параметр масштабирования. Перед этим я хотел делать интерполяцию по прямым от позиции мышки до углов прямоугольника (или до центра картинки, хотя центр картинки), но не стал.
- Система анимации аттрибутов отрефакторена ещё раз. Теперь все анимиационные таски прокручивает один единственный таймер, чтобы сообщения от множества таймеров не захламляли очередь сообщений
- Пофиксил баг: в лайтовом режиме при закрытии окна не воспроизводилась анимация закрытия
- Набор поддерживаемых текстовых файлов расширен, добавлена поддержка .pyw-, .py- и .bat-файлов
- Появился анимированный зум, прям как в Picasa Photo Viewer. Он включён в настройках по умолчанию. Вдобавок зум старается прилипнуть к значению 100% при уменьшении и увеличении масштаба.
- Восстановлена работа фичи SlideShow
- При запуске обычного режима иконка приложения в трее отображется сразу, а не после прогрузки библиотеки
- Обновлена иконка приложения, как и планировалось
- Переписал документацию и текст в UI. Теперь вьювер, библиотека и PureRef(Boards) это страницы, а не режимы. А режимов только два - обычный и лайтовый (упрощённый)
- Исправлен баг. Из-за бага при краше аппликуха перезапускалась чистой без открытой ранее картинки
- Теперь в обычном режиме иконка в трее анимируется во время прогрузок папок
- Режим слайдшоу получил ещё один багфикс: теперь смена последней картинки в списке на первую происходит бесшовно без неприятного эффекта имевшего место
- Исправлены несколько багов:
    - На странице библиотеки приложение больше не крашится, если отображается битый avif-файл, к тому для всех картинок, которые не могут быть отображены пишется не только слово "Ошибка", а ещё и название файла для информативности
    - Если из проводника затребовали папку или изображение к показу, то произойдёт принудительнео переключение со страницы "Библиотека" на страницу "Вьювер"
    - Справке `F1` добавлена прокрутка
    - Приняты меры к устранению дубликатов папок в библиотеке
- Внешний вид формы тегов улучшен
- Все пользовательские данные (сессия, избранное, комментарии, теги, настройки) теперь находятся в папке user_data, а не разбросаны хаотично по всей папке приложения
- Отрефакторил весь код, относящийся к комментированию. Теперь весь код коментов сидит в своём модуле и не размазан по `library_data.py`. Заодно вспомнил, что отключил лишь отображение коментов в лайтовом режиме, а редактирование и создание не отключил совсем. Ещё примечательно, что я хоть и создавал коменты в упрощённом режиме, но старые коменты от этого не перетёрлись и остались. Стабильный кусок кода получился. Вообще я отрубил комменты тогда именно потому, что их загрузка отнимала время, ведь все комменты хранятся в одном файле и их загрузка потребует загрузки и самих изображений, к которым они относятся, а это не гуд для упрощённого (лайтового) режима.
- Пофиксил тулзу кадрирования картинок после рефакторинга
- Отрефакторил код показа центрального лейбла. Заодно исправил баг, когда задание скорости анимации или номера кадра внезапно срабатывали на статической картинке и заставляли прорграмму падать. Вдобавок убрал краш, когда показывается значение скорости или кадра и, при перелистывании картинки, не успев исчезнуть, этой информации все ещё приходится отображаться на соседней статической картинке
- Центральный лейбл теперь может отображать сообщения об ошибках красным цветом букв
- Значение масштаба больше не отображается при попытке зумить картинку, которая выкинула ошибку
- Появилась возможность оперативно переключится между вьювером, библиотекой, pureref-досками (boards) и стартовой страницей через красную угловую кнопку слева вверху. При наведении на кнопку выскочит меню для выбора нужной страницы приложения. Клавиша `Tab` теперь циклически переключает страницы с одной на другую
- Наконец запилил фичу пермещения миниатюрок местами. Что нужно знать:
    - `Ctrl+Клик` по одной миниатюрке даёт выбрать её для перемещния или исключить из выбора
    - Также если зажать `Ctrl` и тащить зажатую левую кнопку мыши, то прямоугольником выделения можно выбрать сразу несколько миинатюрок или исключить несколько из выбора
    - На время всех этих манипуляций прозрачность ряда минатюрок становится полностью нулевой, то есть их хорошо видно
    - Выделение прямоугольником теперь можно начинать из зоны главного окна, всё будет работать идеально, специально убил на это час
    - Убрал баг, из-за которого случайно можно было бы кликнуть по миниатюрке так, что вьювер переключался на неё и весь ряд съезжал
    - В любой момент, если есть хотя бы одна выделенная миниатюрка, её можно вставить в то место, где появляется красный курсор. Он появляется между изображениями, в начале и в конце ряда
- UX: Миниатюры и превьшки папок, видимые на странице библиотеки, теперь создаются по порядку, начиная с первой, чтобы как можно раньше можно было видеть ряд миниатюрок каждой папки. Для вьювера осталось всё как было - превьюшки создатся по порядку в обе стороны начиная от текущей превьюшки в момент открытия папки.
- UX: Усовершенствован модуль комментариев. Теперь если во вьювер поступает запрос на показ картинки, то он проверяет, нет ли комментариев к этой картинке. Если оин есть, то у каждого комента путь к картинке проверяется на доступность. Если такого пути не сущестует более, то путь будет заменён на путь текущей открытой во вьювере картинки. В центральном лейбле вылезет сообщение, что картинка найдена и база обновлена. Картинка тот же час будт добавлена в папку с комментариями в библиотеке
- В контестном меню панели управления после вручую перемещнных миниатюрок теперь пропадает галочка на любом из типов сортировки, как это и должно быть по логике.
- Справка `F1`: текст справки для текущей страницы теперь всегда пишется впереди текста всех остальных страниц
- Порядок изображений можно сохранить в скрытый файл папки через команду контекстного меню панели управления. А если активирована соответствующая настройка, сохранение произойдёт автоматически
- Исправлен баг: Была ситуация, когда запрашиваемой картинки по факту не было и прога отскочила на стартовую страницу. Высветилось сообщение, что пути не существует. Потом я решил перейти во вьювер и увидел, что хоть папка для показа нашлась (папка с комментариями), но для ней не сгенерились превьюшки. Вот теперь они генерятся
- Папки с коментами и избранным теперь запрещено обновлять через кнопку на панели управления, да и вообще нельзя их обновлять. При попытке это сделать вылезет сообщение об ошибке
- UX: Текстовые сообщения в центре теперь задерживаются дольше для возможности прочтения
- Исплавлен баг из-за невнимательного кодинга: после выхода из библиотеки во вьювер не работали трансформации
- Исправлен баг из-за невнимательного кодинга: теперь миниатюрка не подсвечивается под курсором мыши, если курсор мыши в данный момент находится на одной из кнопок панели управления
- История просмотра в самом верху теперь отображается только когда курсор находится у верхушки окна
- Стал доступен полноэкранный режим для панели управления. В этом режиме кнопки и вспомогательный текст скрываются, видно только миниатюрки. В этом режиме намного проще менять порядок этих превьюшек рукопашно, собственно, поэтому полноэкранный режим и был внедрён. Режим запускается через контекстное меню панели управления. В полноэкраннном режиме доступна прокрутка через колесо мыши


### 3й этап (28 сентября 2023 - 31 октября 2023)
- BOARDS (ранее PureRef, интерактивный коллаж)
    - запилено перемемещение и масштабирование доски через мышку
    - запилена отрисовка фреймов картинок и предварительное расположение их айтемами в один ряд, во фрейме айтема пишется разрешение и название файла
    - написаны функции сохранения и восстановления контекста доски (положение вьюпорта, масштаб), которые вызываются при смене папки и при смене страницы
    - клик по миниатюрке в панели управления теперь центрирует камеру на картинке этой миниатюрки
    - при наведении на минитюрку в лейбле панели управления будет отображаться имя файла, его разрешение и название папки
    - ряд миниатюр не центрируется вокруг текущей картинки в папке и его можно скролить мышкой влево или вправо
    - исправлена надпись для процесса подготовки доски, буквы сделаны больше и увеличено расстояние между ними
    - улучшен внешний вид компаса
- Запретил менять страницы, если программа обрабатывает запрос на показ папки или изображения (`handling_input==True`)
- Animation FX
    - теперь во время анимации зума можно перемещать изображение без глитчей
    - исправил косяк со снаппингом к значению 100% при увеличении или уменьшении, когда картинка могла застрять на значении 100% при увеличении, либо при уменьшении. Для снапинга можно использовать ещё такую идею - не создавать новых анимационных тасок зума, если уже есть исполняющаяся таска зума и её конечное значение `image_scale` равно 1.0.
    - для анимации листания картинок (анимация `image_center_point`) хотел задать то же смещение, что используется для анимации зума, чтобы можно было перемещать мышкой картинку во время анимации. Но длительность этой анимации лишь одна десятая секунды, поэтому незачем это делать
    - теперь усиленное кручение колёсиком во время проигрывания анимации зума увеличивает силу этого зума, совсем как в Picasa Photo Viewer. Фича реализована через счётчик, который увеличивается на единицу, если новая анимационная таска начинает работать поверх отменённой незавершённой старой. Это цепное увеличение счётчика заканчивается только тогда, когда на момент создании новой таски не было работающих старых тасок с тем же `anim_id`.
- У окна настроек появился вертикальный кликабельный скроллбар
- BOARDS (интерактивный коллаж)
    - появилась возможность зумить только по одной из осей. Зажатый `Ctrl` и колесо мыши зумят по горизонтали, а зажатый `Shift` и всё то же колесо мыши зумят по вертикали. Нажатие на колесо возвращает картинку к однородному масштабу относительно текущей позиции курсора.
- Исправлен баг: при отображении во вьювере надписи «Загрузка» нажатие на кнопку закрытия не закрывало приложение сразу, и даже после завершения загрузки
- Стояла такая таска: добавить команду вывода всех картинок с комментариями в html-страницу с самими комментариями поверх изображений, которые бы актвировались при наведении мышки. Выполнения этой таски уже не требуется, потому как внутри страницы «Библиотека» есть специальная папка для изображений с комментариями.
- Ряд истории просмотра и боковая панель тегов больше не появляются под курсором мыши, если окно не в фокусе
- Иконка курсора мыши больше не меняется при пролёте над окном, если окно не активно (не в фокусе)
- BOARDS (интерактивный коллаж)
    - на доске отрисовывается сетка. Пока она сделана очень топорно и при сильном отдалении от картинок может лагать, но потом разлагивать, когда скроется. Потом надо будет переделать это всё на замощение через QBrush
    - добавлена минимапа, которую можно включить/выключить по нажатию клавиши `M`. Пока карта занимает весь экран, но потом может быть уменьшена. На карте отображаются фреймы изображений и их центры, точка начала координат и прямоугольник камеры, который может отображать масштаб и центр этой камеры.
    - изменена раскладка кнопок для панели управления. Теперь для каждой страницы программно можно определить свой набор кнопок и обработчиков кликов по ним
    - появилось собственное цикличное слайдшоу с поочерёдными перелётами и зумом. После нажатия на клавишу `Пробел` запускается анимация перелистывания каждой картинки на доске. После повторного нажатия пробела анимация останавливается. Также цикл может пройти по заранее проставленным точкам, выставленным через `Ctrl+LMB`. Если имеется хоть одна выставленная точка, то анимация пойдёт по точкам. ***Пока решил не создавать возможность на лету задавать колесом мыши величину скорости вплоть до полного разворота в противоположную сторону***
    - отрисовка сетки улучшена переходом с `int` на `float`. Улучшения касаются отображения сетки при анимации зума, то есть теперь линии не рябят при анимации.
    - реализована загрузка статического и анимационного контента айтема при появлении области айтема на экране. А превьюшки рисуются теперь при сильном отдалении
    - можно просматривать анимационные файлы покадрово. Кадры можно перелистывать через колесо мыши с зажатой правой кнопкой мыши. Если при зажатой правой кнопке работало колесо, то после отпускания кнопки мыши контекстное меню не появится.
- Отрефакторил многострадальный метод `do_scale_image`. Восстановил снаппинг к 100% при подходе с двух сторон, вернул клампинг в границах между 1% и по 10 000%. Проверил работу инструмента «Лупа», которая зависит от `do_image_scale`. Удалил настройку `legacy_image_scaling`. Убогая старая версия сохранена в файле meseum.py
- Пока рефакторил не особо полезную фичу DeepSecret, то нарвался на пару всратых багов в анимационном зуме и пришлось их исправлять:
    - во время анимации зума перемещение не работало адекватно и из-за этого картинку бесоёбило
    - перемещение глитчило, если после передвижения курсора мыши во время анимации зума держать зажатой кнопку мыши и не отпуская кнопки переместить курсор после окончания анимациии
    - во время анимации зума нельзя плавно зумировать из другой точки, сразу появляется скачок по смещению. Но этот скачок происходит только если во время анимации было произведено перемещение и как раз на величину перемещения
- Отрефакторил и исправил отображение фичи DeepSecret. Проблема была в том, что надпись скользила при увеличении, что разрушало эффект того, что надпись будто бы присутствует на самой картинке. Ещё активация надписи не срабатывала во время анимации зума и это было исправлено.
- Баг: после использования сочетания `Ctrl+Shift` отключается анимация напрочь, так быть не должно
- Вернул скорость зума к обычной. Дополнительно теперь скорость зума сбрасывается, если колесо начинает вращаться в другую сторону.
- Длительность анимации зума теперь задаётся в зависимости от скорости скролла. Чем выше скорость, тем длинее анимация.
- Пофиксил один краш и незагружающиеся svg-файлы на странице BOARDS. По этому случаю отмечу, что полезно бывает запустить анимацию перелистывания по всей странице, ибо если баги есть, то они сразу вылезут
- BOARDS:
    - появилась лупа как во вьювере, только пока работает через `Shift+Клик`, а не через `Ctrl+Клик` как во вьювере. Старым кодом повторно не удалось воспользоваться, копипаст и рефакторинг имён переменных спас ситуацию.
- Исправлен баг: в слайдшоу svg-файлы отображались в мыльном разрешении. Разрешение повышено
- Исправлен баг: в просмотре на странице библиотеки svg-файлы теперь тоже можно видеть в чётком разрешении
- Исправлен баг: задавая область комментария и выходя за рамку наблюдалось странное поведение рамки с отзеркаливанием её от границы картинки. Теперь это исправлено
- Исправлен баг и опечатка: невозможно было зумить доску (zoom) на странице BOARDS пока хотя бы раз не потаскал её в стороны мышкой (panning)
- BOARDS:
    - анимация пролёта по картинкам теперь начинается с той картинки, центр которой ближе к курсору мыши
    - починил отключение анимации пролёта при нажатии на `Пробел`
    - теперь при пролистывании анимационных файлов видно номер текущего фрейма (для этого курсор мыши должен находится над этой картинкой)
    - при переключении со страницы вьювера не пропадал центральный лейбл, отображающий масштабирование в процентах
    - организована выгрузка тех изображений, которые очень далеко отстоят от камеры. **Изначально хотелось начинать выгружать по количеству загруженных и вдобавок делать это рандомно, но пока сужу по расстоянию между центром камеры и центром картинки. Возможно, поздней надо будет сделать настройку для отключения этой фичи**
- Восстановлена работа функции «Перезапустить в обычном режиме»
- Исправлен баг: если произошёл краш в обычном режиме, то и перезапуск должен быть тоже в обычном режиме. Если крашнулось в упрощённом, то и перезапуск в упрощённом
- Комментирование:
    - юзер-френдли заголовок у диалога подтверждения удаления комента
    - при требовании перезадать границы комментария выводится подсказка-сообщение, о том, как можно начать перезадавать границы
- В коде данных md5-строки теперь сравниваются не напрямую, а посимвольно для верности
- В инфе каждого тега теперь прописывается не только md5-хэш изображения, но и размер файла
- Не писать в файл сессии виртуальную папку с комментами
- Записи в тегах теперь организованы по-другому - пути пишутся последними, потому что могут содержать пробелы, а пробел как раз и является разделителем полей в строке
- **Хотел было зарезервировать поля в файлах сессии, избранного, комментариев и файлах тегов. Это нужно было бы, чтобы потом не конвертировать сами файлы, чтобы при записи место для поля уже было занято. Однако я отказался от этого, ибо до релиза ещё далеко, и при надобности я смогу сделать конвертацию потом.**
- Папки избранного, изображений с коментами и изображений с конкретными тегами теперь называются виртуальными.
    - из виртуальных папок нельзя удалять изображения
    - виртуальные папки не прописываются в файле сессии
    - виртуальные папки нельзя обновить (то есть просканировать их заново)
    - нельзя удалить саму виртуальную папку из библиотеки
- BOARDS
    - клавиши `Home` и `End` центрируют вьюпорт на первой и последней картинке соответственно
- В библиотеке для виртуальных папок комментариев и тегов созданы иконки
- Перерисована кнопка «Слайдшоу»
- BOARDS
    - можно гулять по доске нажимая `Page Up` и `Page Down`, в результате камера будет центрироваться на следующей или предыдущей картинке
- Теперь папка новосозданного тега размещается в библиотеке следом за всеми тегами, а не в конец списка
- Переработан один из аспектов системы тегов - список тегов изображения больше не хранится в экземляре `ImageData`, теперь он хранится в специальной переменной главного окна, которая задаётся при загрузке изображения и обновляется при редактировании. Эта переработка убережёт от многих багов
- В упрощёном (лайтовом) режиме
    - отключен просчёт md5-хэшей, папки с большим количеством изображений стали грузится куда шустрей, даже можно сказать моментально
    - отключена отрисовка метаданных
    - отключена отрисовка комментариев
    - отключено обновление статуса кнопки "добавить в избранное"
    - отключена кнопка "добавить в избранное"
    - отрисовка библиотеки пофикшена для работы в упрощённом режиме
    - отключена загрузка всех виртуальных папок
    - отключена загрузка файла сессии
    - введён запрет на удаление папки на странице библиотеки, если папка в списке всего одна
    - удалена функция нахождения пропавших изображений в списке комментариев
    - переработано контекстное меню
    - отключены сочетания клавиш для вызова или создания тегов и комментариев
    - отключена боковая панель тегов
  - хотел отключить историю просмотров, но потом передумал
- Центральный лейбл сообщения теперь может отображаться на всех страницах
- Клавиша `Esc` теперь ещё и чистит вывод сообщений, который происходит поверх изображения
- Добавлены клавиши для быстрого доступа к страницам (5 ноября 2023 уже не актуально)
    - `B`: Board Page
    - `L`: Library Page
    - `V`: Viewer Page
    - `Pause Break`: Start Page
- Отменил планы создания фичи, с помощью которой при открытии любой картинки во вьювере автоматически проверялось, на является ли эта картинка потерянной, то есть в данный момент не доступна по пути, записанному в файле библиотеки. Отмена связана с трудностью её воплощения в упрощённом режиме. Эта фича будет вынесена отдельно в специальную форму
- Слайдшоу: раньше при запуске выход на первую картинку начинался с затухания последней картинки. Теперь такого прикола нет и первая картинка появляется из пустоты как и должна.
- Слайдшоу: вместе с номером слайда отображается и имя файла
- Слайдшоу: теперь в слайдшоу можно увидеть и AVIF-файлы
- Починил отрисовку некликабельных скроллбаров на странице библиотеки
- Починил зум, работающий во вьювере через клавиши `Вверх` и `Вниз` для случая когда эти клавиши зажаты. Снапинг к 100% в этом случае уже не работает, и похуй, пусть так и останется.
- BOARDS
    - перемещение по доске теперь работает с зажатым колесом мыши, а не с зажатой левой кнопкой. Сброс масштаба - средняя кнопка мыши и зажатый `Alt`
- Поиск пропавших файлов по размеру в байтах и хэшу
    - добавлена форма для вывода информации о ходе процесса
    - приостанавливаю разработку с 5 ноября 2023
- Проделал R&D по виджетам трансформации и отрисовке трансформированного контента
    - после прочтения документации по QTransform выяснилось, что можно отрисовывать объекты в QPainter гибко задавая порядок трансформаций (скейл, поворот и перенос)
    - порядок трансформаций при отрисовке контента:
      - (1) скейл (2) поворот (3) перенос
      - чтобы сквошить, после поворота надо сделать ещё один скейл относительно осей мира или осей экрана, то есть не учитывая поворот
    - при повороте надо изменять значение поворота и корректировать положение центральной точки, если пивот не совпадает с ней
    - при скейле надо изменять значение скейла и корректировать положение центральной точки, если пивот не совпадает в ней
    - при повёрнутом виджете для скейла координаты точек оперируются в повёрнутой системе координат
    - пивот и центральная точка не совпадают, когда выделено больше чем один объект
    - входные данные:
        - позиция объекта, скейл по двум осям, поворот, координаты пивота (может совпадать с позицией объекта)
    - выходные данные:
        - позиция объекта, скейл по двум осям, поворот
- Лупа теперь вызывается с зажатым `Alt`, а не c зажатым `Shift` как раньше
- BOARDS
    - Виджет трансформации для каждого айтема на странице
        - выделение айтемов
            - функция создания полигона выделения
            - отрисовка полигона выделения
        - отрисовка контента и вспомогательной инфы согласно локальному скейлу, повороту и позиции
        - выделение айтемов
            - выделение прямоугольником и одиночным кликом
                - модификатор `Shift` для добавления айтемов к уже выделенным айтемам
                - выделение срабатывает и при кручении колеса мыши (зум)
        - !!! реализовано перемещение айтемов по доске БЕЗ СОЗДАНИЯ ВИДЖЕТА ТРАНСФОРМАЦИИ
            - область реакции для начала перемещения - вся область повёрнутого-масштабированного айтема
            - пришлось немного попотеть, чтобы совместить это с функцией выделения, сразу написать работающий код не получилось
                - баги: во время реализации переставал работать зажатый `Shift` при выделении айтемов одиночным кликом
            - особенность, заимствованная из PureRef: если кликается на невыделенном айтеме и есть другие выделенные айтемы, то с выделенных айтемов снимается выделение, а на невыделенный добавляется выделение и, если кнопка мыши остаётся зажатой, то активируется перенос
        - после выделения одиночным кликом левой кнопки мыши айтем начинает рисоваться на переднем плане
- Теперь даблклик по айтему на доске отображает айтем по центру в максимально возможном масштабе
    - вдобавок сделаны поправки к тому, что айтем или группа айтемов может скейлиться и поворачиваться, то есть берётся во внимание bounding_box от selection_area
- Адаптация функций навигации к возможности поворачивать и скейлить айтемы
    - даблклик или клик по миниатюрке в панели управления (уже сделано в прошлом коммите)
    - первая и последняя через клавиши `Home` и `End`
    - листание через клавиши `Page Up` и `Page Down`
    - анимированное слайдшоу через клавишу `Пробел`
    - просчёт `bounding_box` всей доски
    - отрисовка минимапы
- Восстановление порядка изображений из-за перетасовки по причине выделения единичным кликом левой кнопкой мыши для использования в анимированном слайдшоу и прочих навигационных функциях
- BOARDS
    - Переосмыслил проект виджета трансформации. Теперь со вспомогательных контролов виджета не снимается инфа для позиционирования, масштабирования и ориентации объекта, завтра реализую новую задумку
    - виджет трансформации для каждого айтема на странице
        - начальная отрисовка совокупного объёма выделения айтемов
            - объём для одного айтема ориентирован по объекту, для группы айтемов ориентирован по холсту
            - обновление координат объёма при перемещении выделенных айтемов, перемещении вьюпорта и зуме вьюпорта
        - все трансформации и преобразования выполнять в экранных координатах с поправкой на значение зума
        - отрисовка зон активации скейла айтема
        - отрисовка зон активации вращения айтема
        - вращение айтемов
            - группое и одиночное
            - пивотом служит центр совокупного объёма - все айтемы вращаются вокруг него; в одиночном не вращается, потому что радиус в этом случае нулевой
            - угол вращения используется для вращения позиции айтемов вокруг пивота и для вращения самих объектов вокруг их собственных центров
            - под конец вращения при отпускании кнопки мыши виджет переопределяется так, как это сделано в PureRef
            - модификатор `Ctrl` позволяет вращать выделенный айтем на углы, кратные 45 градусам. То же самое работает и для группового выделения
        - баг: виджет трансформации не появляется, если айтем начинают перетаскивать без предварительного выделения
        - скейл айтемов
            - непропорциональный скейл в этой программе возможен только для одного выделенного айтема, для группы выделенных айтемов скейл строго только пропорциональный, потому что айтемы внутри группы могут иметь разные ориентации из-за поворота, и не хочется с этим возиться, потому что оно мне и не надо
        - скейл айтемов (однородный, то есть пропорциональный и неоднородный)
            - думал насчёт схлопывания в ноль при скейле, и придумал задавать изначально малое значение для вьюпорта и обратно большое значение для масштаба контента, это должно помочь от схлопывания в ноль. При подходе к нулю надо ограничивать, не давать умножить на ноль совсем окончательно
            - четыре функции для обработки событий от мыши
            - основной код скейла для группы и для одного айтема, непропорциональный
            - обновление габаритов рамки виджета
            - пропорциональный скейл через `Shift` для одного айтема для всех квадрантов вокруг пивота
            - для пропорционального скейла восстановлено правильное отзеркаливание во всех квадрантах вокруг пивота
            - пропорциональный скейл работает теперь для группы выделенных айтемов, aspect ratio вычисляется уже по размерам рамки выделения
            - эффект от зажатой клавиши `Shift` теперь видно сразу, а не после перемещения мышки при зажатой клавише
            - введён модификатор `Alt` для скейла от центра изображения
            - модификатор `Alt` отключён для скейла группы выделенных айтемов, потому что он работает неправильно и не имеет смысла его исправлять
            - была идейка, что нужно ограничивать скейл минимальным значением, чтобы айтем не схлопнулся в ноль по обоим своим осям. Но сейчас у меня так и не получилось схлопнуть айтем в нулину, как я не старался. Идейка такая возникла из-за прошлого опыта, когда виджет в OXXXY схлопывался в нулину. Но я вспомнил, что виджет схлопывался в нулину только потому что я использовал целочисленные значения для координат. Здесь же в этот раз такой тупизны не было допущено, вдобавок с виджета не снимается никакой инфы для трансформации айтема, и на виджет применяются те же трансформации, что и на сам айтем. Виджет трансформации нужен только для того, чтоба начать масштабирование или вращение, в остальном он просто отрисовывается.
                - Но на всякий случай я написал код, который ограничивает скейл минимальным значением, задаваемым в пикселях **и закомментировал его**. Посмотрим как всё пойдёт на деле.
                - Ещё пара мыслей насчёт решения проблемы: была идея задавать картинкам дефолтный масштаб в 100.0 по каждой из двух осей, а не 1.0, и начальное значение зума для вьюпорта выбирать обратное 1.0/100.0. Но раз я не смог схлопнуть объект в нулину вместе с виджетом, то пусть тогда эта идея останется в этом changelog-e.
                - В самом PureRef можно скейлить до талого, чтобы осталась только одна угловая точка от виджета, но если зазумить вьюпорт к этой точке, там появлялся объект с его родными габаритами, который можно было в свою очередь ещё раз уменьшить. И в конце концов, в один из моментов PureRef не давал уменшить изображение дальше. А у меня такого предохранителя не прописано, этот факт я и решил отметить здесь.
                - Ещё квадраты на углах виджета для активации вращения определяются через векторы, вычисляемые из координат углов прямоугольника виджета трансформации. Эти векторы из-за близкого к нулю масштаба айтема могут спокойно иметь нулевую длину и непонятно как тогда они будут отрисовываться. Лучше бы эти векторы надо было вычислять через переменную вращения и, наверняка ещё потребуется что-то типа aspect ratio. Но пока и так работает, поэтому пока я оставляю как есть.
            - ещё была идейка ограничить отрицательные проекции позиции курсора мыши (как это сделано в PureRef) на aspect-ratio-луч, который начинается в точке пивота и направлен в сторону центра айтема. Но я не стал это делать, потому что отрицательные проекции позволяют легко зеркалить те же картинки в айтемах.
            - так как ограничивать скейл я не стал, то я сделал так, чтобы в случае, когда угловые точки накладываются друг на друга, первой кликалась та угловая точка, которая при нулевом повороте находится справа внизу. Такой небольшой UX, ведь такие мелкие картинки заскейленные в точку я обычно скейлю обратно движением курсора мыши из левого верхнего угла в нижний правый угол
        - проведена проверка работы скейла и поворота айтемов (одиночное и групповое) с разным зумом вьюпорта
        - в процессе скейла айтемов теперь можно менять зум вьюпорта и всё происходящее на экране будет выглядеть адекватно
        - в процессе поворота айтемов теперь можно менять зум вьюпорта и всё происходящее на экране будет выглядеть адекватно
- BOARDS
    - нажатие на клавишу `I` прячет или показывает инфу об айтеме (например, имя файла и разрешение). Перед нажатием на клавишу надобно поместить курсор поверх айтема или выделить его
    - исправлен баг: svg-файлы загружаются на доску в очень мелком разрешении
    - `Ctrl+A` теперь выделяет все айтемы
    - введён запрет выделять айтемы во время работы функции пролёта по айтемам
    - рамка виджета трансформации сбрасывается при использовании навигационных функий, которые перемещают или зумят вьюпорт. При этом сбрасывается выделение с выделенных айтемов
    - bounding box всей доски обновляется после вращения или скейла айтемов. Это актуально для минимапы
    - в минимапе при наведении курсора на фрейм айтема показывается текстовое описание
    - восстановлена нормальная отрисовка инструмента Лупа (`Ctrl+ЛКМ`)
    - UX: клик по выделенному айтему с зажатым `Shift` теперь снимает выделение с этого айтема
    - виджет трансформации теперь плавно затухает, если окно потеряло фокус и плавно появляется, если курсор мышки проносится над окном (как в PureRef)
    - заодно починил то, что испортил в предыдущем коммите: клик с `Shift` перестал выделять айтемы по одному, из-за того, что я не вспомнил, что выделением занимается не только функция `board_selection_callback`, а ещё и `any_item_area_under_mouse`
    - чтобы быстро перемещаться по доске, можно зайти в минимапу, затем навести на нужное место курсор мыши и нажать `Enter` на цифровой или текстовой клавиатуре
    - через `Ctrl+C` и `Ctrl+V` можно копировать выделенные айтемы. Выделенный айтем или группа айтемов встанут центром в ту точку, которую будет указывать курсор мыши
            - заодно пришлось отключить `Ctrl+V` для перехода на страницу вьювера; может стоит заменить их все на `Shift`
    - теперь функция выделения в первую очередь проверяет те айтемы, которые отрисовываются на переднем плане, и это избавляет от раздражающего бага, который проявляется когда один айтем перекрывает другой и в области перекрытия находится курсор
- Изменены шорткаты для быстрого доступа к страницам, теперь это цифры на клавиатуре
    - `1`: Start Page
    - `2`: Viewer Page
    - `3`: Board Page
    - `4`: Library Page
- Рефакторинг: избавлился от таймера в панели управления, теперь за всё отвечает таймер главного окна
- Пошаговое вращение в виджете трансформаций теперь работает более интуитивней
- У виджета трансформаций теперь появились курсоры для скейла и вращения. Каждый из них появляется, когда курсор находится в соотвествующей зоне
- Выделенные айтемы теперь обводятся рамкой цвета из PureRef, а не зелёным как раньше
- Теперь рамка виджета трансформации рисуется толще, чем рамка обводки выделенного айтема
- Отладочная графика виджета трансформации (зоны активации вращения, диагональ aspect_ratio, оси пивота) теперь отображается по запросу. Включить и выключить отладочную графику можно через пункт контестного меню
- Подправил код ориентации курсоров виджета трансформации, чтобы он работал так, как было задумано
- Рассмотрел похожий проект miro https://www.youtube.com/watch?v=m0iOExXL7yI
- BOARDS
    - введена настройка для показа компаса и уровень зума камеры на странице доски
    - введена настройка для показа точки начала координат на доске
    - введена настройка для показа сетки
- Переработан внешний вид окна настроек. Настройки сгруппированы



### 4й этап (31 октября 2023 - ????????)
- BOARDS
    - добавлен новый тип айтема - папка. Файлы в ней можно перелистывать тем же макаром, как и кадры в анимационных айтемах. Айтемы-папки добавляются через команду контекстного меню
        - появляется в центре экрана
        - забирает на себя всё выделение
        - при сканировании добавляются только поддерживаемые изображения
    - восстановлена работа минимапы после внедрения айтемов-папок
    - добавлен новый тип айтема - группа. То же самое, что и айтем-папка. Только она нужна для группировки изображений из текущей папки
    - добавлена возможность открывать изображение с выделенного айтема во второй копии приложения
    - пофиксил баг: рамка виджета при пошаговом повороте не вращалась на пошаговые значения как это делали выделенные айтемы
- исправлен глитч с воспроизведением анимации - кадры в гифке обновлялись только когда мышка елозила по окну
- добавлена настройка для задания размера области активации масштабирования и вращения у виджетра трансформации
- поправил работу зума во вьювере, чтобы колесо мыши не так сильно приближало/отдаляло при начальном кручении колеса. И всё равно мне не понравилось, как работает момент, когда дополнительно крутишь колесо во время анимированного зума: в таком случае все ещё остаются рывки
- рефакторинг: все длины между точками высчитываются теперь через `QVector2D(a-b).length()`
- рефакторинг: использовать `QPainter.boundingBox()` вместо самописных костылей
- избавился от клиент-сервера основанного на файле запроса и таймере
- BOARDS
    - айтемы-группы
        - их можно добавлять через контекстное меню
        - айтемы-НЕгруппы теперь можно выделить и перетащить на айтем-группу, в итоге они переместятся в этот айтем-группу
        - на минимапе теперь отображается индекс группы
- исправлен баг: при переключении страниц программа падает, если она была запущена без запроса показа папки или изображения
- исправлен краш: после нажатия кнопки «Слайдшоу» на панели управления, когда текущая папка пуста
- исправлен баг: панель управления не должна отображаться на стартовой странице, если приложение запущено без запроса показа папки или изображения
- BOARDS
    - при перемещении выделенных айтемов в айтем-группу, выделенные айтемы становятся наполовину прозрачными при нахождении курсора мыши над группой и появляется надпись "добавить в группу"
- восстановлена анимация вьювера при запуске (`anim_id = "image_transform_start"`), которая слетела при правке бага недавно. Вдобавок отключена анимация ряда миниатюр, которая включилась некстати
- BOARDS
    - исправил краши с айтемами-папками и айтемами-группами в коде навигации по доске (дабл-клик, `PageDown`, `PageUp`, `Home`, `End`, `Пробел`)
    - баг: окружность компаса была залита чёрным цветом
    - "поддоски": ныряние в доску айтема (ITEM_FOLDER или ITEM_GROUP) и выныривание из неё. Можно было бы разворачивать группу или папку на всю доску, но это будет неудобно, потому что развёрнутый режим может перекрывать другие айтемы на доске
        - навести курсор на любой такой айтем и нажать `Enter` (цифровая клавиатура) или `Return`
        - ссылка на предыдущую доску сохраняется для возврата назад с помощью клавиши `Backspace`, во вьюпорте в левом верхнем углу отображается напоминание об этом
        - параметры доски копируются в память папки (в терминах библиотеки)
- добавил настройки прозрачности для доски, вьювера и стартовой страницы в полноэкранном режиме
- в оконном режиме на заднем фоне теперь чёрный цвет, а не неприятный серый
- функция задания картинки для курсора не работала, если не была создана панель управления (актуально, когда первой показывалась библиотека или стартовая страница)
- BOARDS
    - надпись «Подожди» теперь сопрождается дополнительной надписью «создаются превьюшки»
    - теперь добавление айтема-папки сопровождает плашка на время загрузки данных
    - теперь можно добавлять айтемы-изображения через `Ctrl+V` из проводника
    - если айтем можно прокручивать, то теперь можно узнать что это за айтем - анимация, группа или папка
    - теперь доступно удаление выделенных айтемов с доски через клавишу `Delete` (в данный момент отменить это действие нельзя и истории действий как такой ещё нет)
    - добавлена переменная-ссылка на данные основной доски для досок айтемов-групп. Ещё предусмотрена ссылка на сам айтем. Теперь возможна дифференциация досок по этим ссылкам
- добавлена поддержка чтения .cur-файлов
- BOARDS
    - пофиксил ныряние от зацикленности
- если файл не поддерживается, но есть в списке, то в сообщении об ошибке отображается имя файла
- BOARDS
    - новый тип айтема для доски - айтемы-фреймы, в основном несут чисто вспомогательную функцию, визуально обводят группу айтемов
        - создаются на доске через команду контекстное меню, перед этой командой надо выделить нужные айтемы
        - **пока заголовки этих айтемов-фреймов менять невозможно**
        - перетаскивая айтем-фрейм, перетаскиваешь и все айтемы, которые визуально распологаются в нём. Айтем-фрейм не хранит список айтемов, которые распологаются в его области, этот список заново определяется на лету при всякой необходимости
        - айтем-фрейм выделяется простым кликом мыши, если при клике под курсором мыши не находится ни один другой айтем любого типа
        - для айтемов-фреймов отключено вращение
        - лейбл отображается до тех пор, пока его ширина не больше, чем ширина айтема или когда курсор мыши находится поверх айтема-фрейма
    - в настройках теперь можно отключить выгрузку изображений из айтемов, которых в данный момент не видно на экране
    - при создании айтема-группы выделенные айтемы теперь сразу переходят в группу айтема
    - в контекстное меню добавлена команда загрузки хайрезных версий всех айтемов доски по требованию. Работает особенно отлично, когда выключена автоматическая выгрузка изображений (настройка была введена сегодня и описана чуть выше). Может привести к перерасходу памяти
    - теперь можно нырнуть и в анимированные изображения, а на доске будут кадры из анимированного изображения
        - **выгрузка контента и освобождение памяти не реализованы**
    - около начала координат каждой доски теперь выводится инфа о доске вместе с технической
    - из браузера можно вставлять картинки прямо на доску. Для этого в браузере у картинки надо вызвать контекстное меню, в котором выбрать пункт "Копировать картинку". Потом вернувшись на доску надо нажать `Ctrl+V`. Так копируются только статические картинки, у gif-анимации скопируется только первый её фрейм (кадр)
    - теперь из браузера можно перетаскивать картинки на доску (как в PureRef), желательно перетаскивать картинку, которая открыта в отдельной вкладке, иначе может не сработать. Картинка не перетаскивается как есть, перетаскивается инфа о ссылке на неё и приходится эту картинку выкачивать.
        - если браузер открыл картинку доступную только через VPN-плагин встроенный в браузер, то скачать его на доску не получится
        - сохраняется ссылка на картинку, эту ссылку можно увидеть, если нажать клавишу `I` когда курсор находится над айтемом картинки
        - могут быть проблемы с расширениями файлов, хотя я сделал всё возможное, чтобы вытащить расширение файла из хэдеров ответа на запрос, на случай если в самом url данных о расширении не будет предоставлено
    - стояла таска: какие элементы надо запретить к копированию
        - **в итоге пока решил не ограничивать**, хотя изначально копирование айтема-папки выглядело тупо, ведь копия завязана на одну и ту же папку в библиотеке, то есть при перелистывании одной копии, все остальные копии будут перелистываться в унисон
    - стояла таска: ограничить вставку картинок на некоторые типы досок
        - например, ограничить вставку картинок на доски анимационных файлов, это имело бы смысл
        - **в итоге решил не ограничивать пока**
    - стояла таска: ограничивать создание айтемов разных типов для разных типов досок
        - **в итоге решил пока не ограничивать**
    - **пришла идея сделать табы для открытых досок, чтобы не приходилось лезть в библиотеку для переключения между ними каждый раз. Число табов будет расти по мере ныряния в новые доски. Но это не сейчас, это потом**
    - теперь не только один айтем можно посмотреть в максимальном мастабе (даблклик по айтему), а и все те, что былы выделены. После выделения нужных элементов надо только нажать клавишу `+` на нампаде (numpad)
- исправлен баг: в анимационных файлах не отображались сообщения по центру, в том числе значение скейла и номер кадра
- BOARDS
    - UX: теперь можно отменить перенос айтемов во время переноса через клавишу `Esc`
    - UX: теперь можно отменить вращение айтемов во время вращения через клавишу `Esc`
    - UX: теперь можно отменить скейл айтемов во время скейла через клавишу `Esc`
    - исправлен баг: теперь при перемещении айтемов не съезжает относительное расстояние между курсором и позицией нажатия кнопки мыши, если при этом одновременно изменять зум колесом мыши
    - добавлена настройка: при первом открытии доски из вьювера центрировать вьюпорт доски на текущей картинке
    - реализована возможность выделять внутренние айтем-фреймы, лежащие во внешних айтемах-фреймах
    - баг: если внутренний айтем-фрейм зацепляет середину внешнего айтема-фрейма, то родительский айтем-фрейм перемещается тоже, а вообще-то не должен
    - исправлен баг: при добавлении айтемов в группу, на доске группы они отображались со старым расположением относительно начала координат. Теперь они все встают в ряд, даже при добавлении. **Ещё обнаружил, что у айтемов в группе не прописываются толком индексы айтемов, но это не так уж и важно в данный момент.**
    - виртуальные папки могут носить одинаковые названия (переменная `folder_path`)
    - введён запрет на добавление айтемов-групп на доски групп
    - пофиксил баг: после клика по картинке без перетаскивания её не работало закрытие окна через клавишу `Esc` (и многие другие вспомогательные функции, повешенные на эту клавишу)
    - теперь запрещено удалять картинки (клавиша `Delete`) из досок анимированных картинок
    - теперь удаляемые айтемы-изображения из доски папки и из доски любой группы помещаются в специальную группу типа корзина, она будет располагаться в корневой невиртуальной папке, которая связана с папкой файловой системы Windows (очень мудрёно написал, потом перепишу)
    - теперь при удалении группы все её содержимое перемещается в группу для удалённых айтемов
    - UX: теперь одинарным кликом левой кнопки мыши можно выделить айтем-картинку, которая имеет самую наименьшую площадь из находящихся под курсором
    - UX: теперь через команду контекстного меню `Вынуть текущую картинку из группы` можно обратно доставать айтемы на доску

----------------------------------------- 2024 ------------------------------------------

- введена переменная `FORCE_FULL_DEBUG` для загрузки программы в обычном режиме из дебага
- исправлен баг: при каждом перезапуске в обычном режиме файл сессии писался по-разному: текущее изображение для некоторых папок было либо файлом не поддерживающим просмотр, либо поддерживающим
- исправлен баг: в упрощённом режиме приложение остаётся висеть в памяти, если окно закрылось через всплывающую миниатюру окна или через контекстное меню панели задач Windows
- улучшен UX при отладке обычного режима - при старте сразу грузится папка, а клавиша `Esc` закрывает программу вне зависимости от настроек.
- UX: прятать форму тегов, когда по лейблу одного из тегов кликнули правой кнопой мыши
- лейблы тегов на форме тегов теперь показывают количество закреплённых к ним изображений
        - лейблы тегов динамически изменяют количество закреплённых к тегам изображений после каждого клика по ним
- введено контекстное меню для каждого тега в форме тегов
- теперь можно редактированить описания тегов: описание можно редактировать в той же самой форме. Режим редактирования активируется через контекстное меню лейбла каждого тега. После изменения описания надо нажать кнопку «Сохранить» и тогда форма вернётся в режим редактирования тегов для изображения.
    - в режиме редактирования описания тега невозможно кликать по лейблам тегов.
- при наведении на лейбл тега в форме тегов можно будет увидеть подсказку с текстом описания этого тега
- теперь из формы редактирования тегов для изображения можно удалить тег и всю его информацию
    - при удалении тега удаляется инфа из базы данных в оперативной памяти, удаляются файлы с информацией с диска, удаляется виртуальная папка тега из библиотеки
    - теги таким образом можно удалять только через форму тегов. Невозможно удалить тег через удаление его виртуальной папки на странице библиотеки
- во всплывающих подсказках для лейблов тегов теперь прописывается ID тега
- если описание тега редактируется в данный момент, то он теперь подцвечивается жёлтым
- доступен поиск потерянных картинок в специальной форме; форма отображается через клавишу `Q`
    - алгоритм
        - все изображения, которые помечены тегом, имеют комментарии или добавлены в избранное, проверяются на существование по путям на диске. Если файл отсутсвует по прописанному пути, то он добавляется на поиск, вдобавок из записей запоминается размер в байтах и значение md5-хэша
        - в выбранной папке проводится сканирование для поиска потерянных файлов
            - сначала проверяется папка, в которой раньше лежал файл и если её не существует или файл не найден, то перебираются все предложеные папки в глубину
                - сперва проверяется совпадение расширения в именах файлов
                - потом проверяется совпадение размера в байтах
                - под конец вычисляется md5-хэш файла и проверяется совпадение с записанным значением md5-хэша
                - если все проверки пройдены, то создаётся запись об этом
        - исправляются записи в памяти и на диске, обновляются виртуальные папки на странице библиотеки
    - проверка
        - проверку делать через порчу записей в файлах папки user_data. Нужно просто добавлять лишние символы в имя файла
    - done-лист
        - нахождение потерянных записей в комментариях
        - вывод записей в текстовой вывод
        - нахождение потерянных записей в избранном
        - сканированние в папках
        - замена записей для избранного в оперативной памяти и на диске, генерация превьюшек
        - замена записей для коментов в оперативной памяти и на диске, генерация превьюшек
        - замена записей для тегов в оперативной памяти и на диске, генерация превьюшек
    - **для дальнейших доработок**
        - поиск вглубь по набору папок предусмотрен в коде, но не задаётся через интерфейс
        - при определении потерянных записей надо оставлять ссылки на структуры данных, которые затем придётся править, чтобы не тратить время на их повторный поиск
        - поиск файла в папке очень тупой и неоптимизированный, например, для каждой потерянной записи в каждой папке для поиска будет заново просчитываться размер и md5-хэш
        - текстовой вывод малоинформативный и недоработанный
- исправлен баг: при переключении между оконным и безоконными режимами приложение внезапно закрывалось
- BOARDS
    - добавлена настройка `use_cbor2_instead_of_json`: использовать CBOR2 вместо JSON для записи данных доски в файл
    - исправлен баг: при скейле относительно противоположного угла как раз именно этот самый противоположный угол съезжал по координатам. Особенно это было заметно, если был задан поворот. Противоположный угол являлся пивотом и его координаты были сохранены и не должны были менятся, однако, выяснилось, что они перезаписываются в методе определения угла поворота для курсора.
    - теперь можно вращать айтемы относительно угла, для этого надо зажать `Alt`, но зажимать клавишу `Alt` надо тогда, когда кнопка мыши уже зажата
- UX: теперь окно можно прятать кликнув по иконке на панели задач Windows
- UX: теперь можно переключаться в полноэкранный режим с помощью клавиши `F11`. Выход из полноэкранного режима производится повторным нажатием
- UX: реализована поддержка чекбоксов в контекстном меню
        - добавлен чекбокс «DEBUG»
        - добавлен чекбокс «Антиальясинг и сглаживание пиксмапов»
        - добавлен чекбокс «Pixmap-прокси для пометок типа «Текст»»
BOARDS
  - баг: исправил бажную и нелогичную реализацию начала перетаскивания айтемов. Ранее эти же исправления были внесены в OXXXY 13 марта
  - новый типа айтема: айтем-заметка (ITEM_NOTE)
      - добавлена команда в контекстное меню
      - перенёс код отрисовки
      - перенёс отключение искажений из-за масштабирования (локальный масштаб при отрисовке применяется к длине и ширине и сам масштаб становится равным 1 по обеим осям)
      - теперь айтем может быть активирован одиночным кликом для редактирования
      - проставление курсора ввода через клик мышки
      - подключёна обработка нажатий клавиш клавиатуры
      - деактивация через нажатие клавиши `Esc`
      - автоматическая деактивация режима редактирования при
          - нырянии в другую доску
          - при начале любых трансформаций айтемов
          - при смене страницы приложения
      - баг: при нажатии клавиш `WASD` не только вводился текст, но и сдвигался вьюпорт. Теперь этого не происходит
      - айтем не будет исключаться из пролётов (клавиша `Пробел`) и других навигационных функций (клавиши `PageDown` и `PageUp`)
      - клик средней кнопкой мыши по айтему-заметке откроет либо сайт, на который она указывает, либо папку или файл на компьютере
  - баг: во время зумирования вьюпорта область выделенного айтема закрашивалась сплошным чёрным цветом
- UX, баг: после переработки метода ShowMaximized, отвечающего помимо прочего за обработку нажатия клавиши `F11`, переход из оконного режима в безрамочный вызывал сдвиг изображения относительно экранного пространства. Это исправлено
BOARDS
  - размер шрифта айтема-заметки теперь полностью задаётся через виджет трансформации
  - UX: теперь у айтема-заметки будет отступ от рамки виджета (чтобы было видно курсор в самых крайних его расположениях)
  - исправлен баг: при текстовом вводе с некоторыми клавишами срабатывали команды подключённые к той или иной клавише
  - исправлена отрисовка курсора в текстовом поле айтема-заметки (актуально для всех строк кроме первой)
- заметка: не буду изменять названия страниц. Ранее планировалось изменить `viewer` на `images`, а `library` на `folders`
BOARDS
  - айтем-заметка (ITEM_NOTE) теперь становится активным сразу после создания
  - для айтема-заметки (ITEM_NOTE) реализован мигающий курсор ввода текста
  - UX: для айтема-заметки (ITEM_NOTE) отменено нажатие на колесо мыши для прохождения по ссылке в заметке. Теперь это делается через контекстное меню
  - заметка: хотел было сегодня поставить диалог выбора цвета текста и подложки для айтема-заметки, но оказалось, что в стандартном QColorDialog задание прозрачности сделано через жёппу, поэтому буду делать свой диалог на основе https://github.com/nlfmt/pyqt-colorpicker . Хвала опенсорсу и свободным лицензиям - хоть это не придётся писать с нуля.
  - UX: господи-наканецта: теперь можно задавать прозрачность и цвет для подложки и текста у айтема-заметки (ITEM_NOTE). Всё работает так же, как и в PureRef, только HSV-полей нет
  - UX: выделение текста внутри айтема-заметки (ITEM_NOTE)
    - базовый код (задание выделения и отрисовка, перехват задания атрибута `board.active_element`)
    - редактирование текста активируется теперь через двойной клик левой кнопки мыши
    - рефакторинг кода, при активации айтема выделяется весь текст, курсор ввода перемещается в крайнюю правую позицию; при вводе выделение затирается
    - поддержка отмены действия и повторения отменённого действия (`Ctrl+Z`, `Ctrl+Y`)
    - UX: курсор перестаёт мигать, когда он перемещается
    - UX: модификаторы с клавишами стрелок `Влево` и `Вправо`
      - зажатие `Shift` создаёт выделение
      - зажатие `Ctrl` позволяет перескакивать по словам
    - UX: поддержка клавиш-стрелок `Вверх` и `Вниз` для выделений и переноса курсора между строками
    - UX: drag'n'drop для выделения при использовании зажатой левой кнопки
        - без `Ctrl` происходит перемещение выделенного текста в заданную курсором мыши позицию
        - вместе с зажатым `Ctrl` происходит копирование выделенного текста в заданую курсором мыши позицию
        - теперь при активации drag'n'drop задаются курсоры в зависимости от того зажата ли клавиша `Ctrl`
        - отмена через нажатие клавиши `Esc` в процессе drag'n'drop
        - блокировка взаимодействия с клавиатурой до отпускания левой кнопки мыши
- UX: приложение перестаёт перезапускаться, если оно запускается из дебажного режима
BOARDS
  - система плагинов
      - обнаружение файлов в папке плагинов
      - загрузка плагинов (черновая)
      - заполнение контекстного меню приложения пунктом от каждого плагина
      - расширение функции регистрации
      - активация плагина
      - перезадание функции отрисовки на примере отладочного плагина TANGENTS CHAIN (ранее EXAMPLE PLUGIN)
      - перезадание функций обработки нажатия кнопок мыши и скролла колеса мыши
      - создание виртуальной папки для плагина и переход в неё при активации плагина
      - перезадание функции наполнения контекстного меню
      - перезадание функции обработки состояния клавиш клавиатуры
      - отладочный плагин TANGENTS CHAIN (ранее EXAMPLE PLUGIN) доработан так, чтобы поддерживать паннинг и зум и при этом сохранять прежнее управление
      - активация досок плагинов перемещена в подменю контекстного меню
      - команды плагина в контекстном меню теперь показываются ближе к командам доски
      - в шаблоне TEMPLATE PLUGIN доступны новые колбэки для реализации Drag&Drop
  - исправлен глич курсора на странице доски, когда курсор наводится на угловые кнопки и угловое меню
  - плагин TEMPLATE PLUGIN `template_plugin.py`
      - для удобства разработки следующих плагинов
          - в нём прописаны все колбэки, которые должны быть и вызов дефолтных методов изнутри этих колбэков
  - плагин WATCH TOWER
      - добавляет на виртуальную доску изображения из списка папок, задаваемого заранее в текстовом файле `\user_data\watch_tower.data.txt`
      - изображения из каждой папки представлены отдельным столбцом
      - столбец начинается от самого позднего и заканчивается самым ранним файлом по дате создания
      - в контекстное меню добавлена команда, которая позволит открыть файл данных и редактировать его в тектовом редакторе
  - сохранение и загрузка файла доски
      - сохранение и загрузка файла доски через `Ctrl+S` и `Ctrl+O` соответственно
      - во время дебага `Globals.DEBUG = True` можно открыть недавно сохранившийся файл, для этого нужно нажать сначала `Ctrl+S`, а потом `Ctrl+O`
      - поправил код так, чтобы анимированные айтемы скролились после загрузки из файла доски
      - переписал генератор reg-файла, после активации которого .board-файлы можно открывать в Image Viewer двойным кликом
          - сам Image Viewer пока не понимает, что открывается файл доски и надо переключиться на страницу доски
      - сохранение и загрузка айтемов-папок внутри доски
      - сохранение и загрузка айтемов-групп внутри доски
      - сохранение и загрузка айтемов-заметок внутри доски
      - сохранение и загрузка айтемов-фреймов внутри доски
      - сохранение и загрузка юзер-поинтов внутри доски
      - если `Ctrl+S` нажато в зависимой доске, то будет сохраняться корневая доска (корневая доска - доска, которая не залинкована через айтем другой доски)
      - сделал загрузку файла доски из проводника
      - протеcтировал загрузку невалидного файла доски
      - можно запускать приложение на странице доски с нужным плагином через командную строку, например, `viewer.pyw -board watch_tower.py`
  - плагин BOOKMARKS
      - идея
          - на виртуальной доске будет содержать айтемы-группы, каждый из которых будет представлять книгу, видео или другой файл
          - внутри каждого айтема-группы будет доска со скринштами и заметками по файлу, который представляет айтем-группа
      - при вызове плагина вместо формирования новой доски грузится сохранённая доска, если она существует (доску можно открыть даблкликнув по файлу доски в проводнике, но это намного менее удобно)
      - теперь через команды контекстного меню можно редактировать некоторую метаинформацию айтема-группы (имя файла и текущая страница)
  - плагин IDEAS DEV
      - идея
          - плагин для сопровождения работы над идеями и концептами. Помогает собрать в кучу изображения, видео и текст и следить за правками
  - плагин FRONT TRACKER
      - плагин для парсинга данных в текстовых файлах, форматируемых отступами (символами табуляции или пробела), и представления этих данных на доске
      - группы это файлы, группы перенимают названия файлов, названия групп выводятся горизонтально
      - каналы это именованные разделы внутри файлов, названия каналов выводятся под углом 90 градусов
      - доска поддерживает зум и панорамирование
      - в первом файле настроек `front_tracker.data.txt` задаются папки для сканирования и нахождения в них текстовых файлов для парсинга
      - во втором файле настроек `front_tracker.exclude.data.txt` задаются исключения для сканирования: или целое имя файла, или начальный суффикс имени файла, который надо исключить из сканирования
      - подцвечивается текущая группа и текущий канал, над которым находится курсор мыши
      - UX: надписи названия видимой группы и видимых каналов всегда в видимой зоне, даже если они должны были бы пропасть из неё
      - можно менять ширину канала кликом левой кнопки мыши
      - поддержка разного indent-уровня у разных текстовых файлов
      - парсинг: предотвращение слипания несколько тасок в одну если между ними нет пустой строки
      - в файл `front_tracker.data.txt` можно теперь вносить и ссылки на файлы для сканирования
      - через команду контекстного меню "Front Tracker: open task in Sublime Text" можно открыть текстовой файл на строке, с которой начинается таска
      - содержимое `front_tracker.exclude.data.txt` теперь прописывается в `front_tracker.data.txt` и каждая строка предваряется знаком `~`
  - пофиксил краш на загрузке картинок при перетаскивании их из браузера, если сам URL содержит пробелы в имени файла
  - UX: папки-айтемы теперь можно добавлять через Drag&Drop прямо из проводника
